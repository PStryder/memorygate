# MemoryGate Environment Configuration

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/memorygate

# OpenAI API (for embeddings)
OPENAI_API_KEY=sk-...

# OAuth Configuration
OAUTH_REDIRECT_BASE=http://localhost:8000
FRONTEND_URL=http://localhost:3000
PSTRYDER_DESKTOP=your-client-id
PSTRYDER_DESKTOP_SECRET=your-client-secret
PSTRYDER_DESKTOP_REDIRECT_URIS=http://localhost:3000/oauth/callback

# MCP Authentication
# Set to "false" to disable auth during local debugging (NOT RECOMMENDED FOR PRODUCTION)
REQUIRE_MCP_AUTH=true

# Database initialization (disable auto-upgrade in production)
AUTO_CREATE_EXTENSIONS=true
AUTO_MIGRATE_ON_STARTUP=false
CLEANUP_INTERVAL_SECONDS=900
# MEMORYGATE_TENANCY_MODE=single

# Rate limiting (recommended for production)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_GLOBAL_PER_IP=120
RATE_LIMIT_GLOBAL_WINDOW_SECONDS=60
RATE_LIMIT_API_KEY_PER_KEY=600
RATE_LIMIT_API_KEY_WINDOW_SECONDS=60
RATE_LIMIT_AUTH_PER_IP=10
RATE_LIMIT_AUTH_WINDOW_SECONDS=60
RATE_LIMIT_MAX_CACHE_ENTRIES=10000
RATE_LIMIT_TRUSTED_PROXY_COUNT=0
# RATE_LIMIT_TRUSTED_PROXY_IPS=10.0.0.1,10.0.0.2

# Optional Redis backend for distributed rate limiting (requires `pip install redis`)
# RATE_LIMIT_REDIS_URL=redis://localhost:6379/0

# Request size limits
REQUEST_SIZE_LIMIT_ENABLED=true
MAX_REQUEST_BODY_BYTES=262144

# Input limits
MEMORYGATE_MAX_RESULT_LIMIT=100
MEMORYGATE_MAX_QUERY_LENGTH=4000
MEMORYGATE_MAX_TEXT_LENGTH=8000
MEMORYGATE_MAX_SHORT_TEXT_LENGTH=255
MEMORYGATE_MAX_DOMAIN_LENGTH=100
MEMORYGATE_MAX_TITLE_LENGTH=500
MEMORYGATE_MAX_URL_LENGTH=1000
MEMORYGATE_MAX_DOC_TYPE_LENGTH=50
MEMORYGATE_MAX_CONCEPT_TYPE_LENGTH=50
MEMORYGATE_MAX_STATUS_LENGTH=50
MEMORYGATE_MAX_METADATA_BYTES=20000
MEMORYGATE_MAX_LIST_ITEMS=50
MEMORYGATE_MAX_LIST_ITEM_LENGTH=1000
MEMORYGATE_MAX_EMBEDDING_TEXT_LENGTH=8000

# Embedding retries/timeouts
EMBEDDING_TIMEOUT_SECONDS=30
EMBEDDING_RETRY_MAX=2
EMBEDDING_RETRY_BACKOFF_SECONDS=0.5
EMBEDDING_RETRY_JITTER_SECONDS=0.25
EMBEDDING_FAILURE_THRESHOLD=5
EMBEDDING_COOLDOWN_SECONDS=60
# EMBEDDING_HEALTHCHECK_ENABLED=false

# Security headers (recommended for production)
SECURITY_HEADERS_ENABLED=true
SECURITY_HEADERS_ENABLE_HSTS=false
SECURITY_HEADERS_HSTS_MAX_AGE=31536000
SECURITY_HEADERS_HSTS_INCLUDE_SUBDOMAINS=true
SECURITY_HEADERS_HSTS_PRELOAD=false
SECURITY_HEADERS_REFERRER_POLICY=no-referrer
SECURITY_HEADERS_X_FRAME_OPTIONS=DENY
SECURITY_HEADERS_PERMISSIONS_POLICY=geolocation=(), microphone=(), camera=()
# SECURITY_HEADERS_CSP=default-src 'self'; frame-ancestors 'none'; base-uri 'none'

# Optional host allowlist (comma-separated)
# TRUSTED_HOSTS=memorygate.ai,localhost,127.0.0.1

# Google OAuth
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth
# Get credentials from: https://github.com/settings/developers
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# Production settings (override these in production)
# OAUTH_REDIRECT_BASE=https://memorygate.fly.dev
# FRONTEND_URL=https://memorygate.ai
